version: "3.7"
services:
  db:
    image: mariadb:10.5
    restart: always
    ports: 
    - 3306:3306
    environment:
      MYSQL_ROOT_PASSWORD: R00t
      MYSQL_DATABASE: bilan
    volumes:
      - ./anexo_script_ddl/Anexo3.csv:/home/Anexo3.csv
      - ./anexo_script_ddl/bilandb.sql:/docker-entrypoint-initdb.d/bilandb.sql
  # optional for changing data in the database using ui-client
  adminer:
    image: adminer
    restart: always
    ports: 
      - 8081:8080
  
  backend:
    build:
      context: .
      dockerfile: ./Dockerfile
      args:
        JAR_FILE: ./core/target/bilan-backend-0.0.1-SNAPSHOT.jar 
    depends_on: 
      - db
    ports:
      - 8080:8080
    environment:
      SPRING_DATASOURCE_URL: jdbc:mysql://db:3306/bilan?autoReconnect=true&useSSL=false
            
